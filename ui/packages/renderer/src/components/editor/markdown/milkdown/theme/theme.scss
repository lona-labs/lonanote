.milkdown {
  // 背景颜色
  --crepe-color-background: var(--color-background);
  // 前景颜色
  --crepe-color-on-background: var(--gray-12);
  // 次要背景颜色 (如代码块的背景颜色
  --crepe-color-surface: var(--gray-2);
  // 次要背景颜色 (如弹出的语言选择列表背景颜色
  --crepe-color-surface-low: var(--gray-4);
  // 次要前景颜色 (如代码块功能按钮的前景颜色
  --crepe-color-on-surface: var(--gray-12);
  // 次要前景颜色 (如代码块语言选择按钮的前景颜色
  --crepe-color-on-surface-variant: var(--gray-11);
  // 边框颜色 (如无序列表、有序列表的圆点颜色
  --crepe-color-outline: var(--gray-11);
  // 主颜色 (如链接颜色
  --crepe-color-primary: var(--accent-10);
  // 次要颜色 (如数学公式右上角的Hide按钮
  --crepe-color-secondary: var(--gray-4);
  // 次要前景颜色 (如数学公式右上角的Hide按钮
  --crepe-color-on-secondary: var(--gray-12);
  // 图片块右上角按钮的背景颜色
  --crepe-color-inverse: var(--gray-12);
  // 图片块右上角按钮的前景颜色
  --crepe-color-on-inverse: var(--gray-1);
  // 内联代码的前景颜色
  --crepe-color-inline-code: var(--accent-11);
  // error的颜色
  --crepe-color-error: var(--red-6);
  // 鼠标hover状态的背景颜色
  --crepe-color-hover: var(--gray-6);
  // 文本选择区域的背景颜色
  --crepe-color-selected: var(--accent-a5);
  // 内联代码的背景颜色
  --crepe-color-inline-area: var(--gray-5);

  --crepe-font-title:
    -apple-system, BlinkMacSystemFont, 'Open Sans', 'Helvetica Neue', Helvetica, Arial,
    'Hiragino Sans GB', 'WenQuanYi Micro Hei', 'Noto Sans CJK SC', 'Microsoft YaHei', STHeiti,
    'Microsoft Jhenghei', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
  --crepe-font-default:
    -apple-system, BlinkMacSystemFont, 'Open Sans', 'Helvetica Neue', Helvetica, Arial,
    'Hiragino Sans GB', 'WenQuanYi Micro Hei', 'Noto Sans CJK SC', 'Microsoft YaHei', STHeiti,
    'Microsoft Jhenghei', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
  --crepe-font-code: Consolas, 'Liberation Mono', Menlo, Courier, monospace;

  --crepe-shadow-1: 0px 1px 3px 1px rgba(0, 0, 0, 0.15), 0px 1px 2px 0px rgba(0, 0, 0, 0.3);
  --crepe-shadow-2: 0px 2px 6px 2px rgba(0, 0, 0, 0.15), 0px 1px 2px 0px rgba(0, 0, 0, 0.3);

  // 待办列表的checkbox
  milkdown-list-item-block li .label-wrapper .checkbox svg {
    fill: var(--crepe-color-primary);
  }
  // 代码块弹出的语言选择列表
  milkdown-code-block .list-wrapper {
    border-radius: var(--radius-1);
  }
  // 引用块的背景颜色
  .ProseMirror blockquote::before {
    background: var(--gray-6);
  }
  // 引用块的字体颜色
  .ProseMirror blockquote p,
  .ProseMirror blockquote milkdown-list-item-block li .label-wrapper {
    color: var(--gray-10);
  }

  .milkdown-yaml-block {
    .cm-editor {
      background: var(--crepe-color-surface);
    }
    .cm-gutters {
      border-width: 0 !important;
      width: 0;
    }
  }
  .cm-scroller {
    justify-content: start;
  }

  milkdown-toolbar,
  milkdown-link-preview,
  milkdown-link-edit {
    position: fixed;
  }

  milkdown-link-preview,
  milkdown-toolbar {
    z-index: 10;
  }

  milkdown-slash-menu,
  milkdown-markdown-menu {
    position: fixed;
    z-index: 999;
  }

  // milkdown-latex-inline-edit {
  //   position: fixed;
  // }

  milkdown-link-edit .link-edit {
    --milkdown-link-edit-height: 40px;
    width: 300px;
    height: var(--milkdown-link-edit-height);
    .input-area {
      width: 100%;
    }
    .confirm {
      width: var(--milkdown-link-edit-height);
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
    }
  }
  milkdown-link-preview .link-preview {
    --milkdown-link-preview-height: 40px;
    width: 350px;
    height: var(--milkdown-link-preview-height);

    .link-display {
      width: 100%;
      line-height: var(--milkdown-link-preview-height);
      text-align: center;
      align-self: center;
    }
    .link-icon,
    .link-edit-button,
    .link-remove-button {
      width: 50px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
  }

  milkdown-image-block.selected > .image-wrapper::before {
    background: color-mix(in srgb, var(--crepe-color-selected), transparent 60%);
  }
  // milkdown-image-inline.selected > img {
  //   filter: brightness(1);
  // }

  milkdown-image-block > .image-wrapper {
    margin: 0;
    img {
      object-fit: contain;
    }
    .image-block-title {
      display: none;
      pointer-events: none;
      width: 100%;
      background-color: var(--gray-a3);
      color: var(--crepe-color-on-inverse);
      position: absolute;
      top: 0px;
      left: 0;
      text-align: center;
    }
    .image-block-title.visible {
      display: block;
    }

    .image-resize-handle {
      transition: all 0.2s;
      opacity: 0 !important;
      display: flex;
      justify-content: center;
      align-items: center;
      background: none;
      border-radius: 10px;
      background-color: var(--gray-a10);
      color: var(--crepe-color-on-inverse);
      width: 24px;
      height: 24px;
      left: unset;
      right: -12px;
      bottom: 0px;
      cursor: nwse-resize !important;
      svg {
        width: 14px;
        height: 14px;
      }
    }
    .operation {
      top: 4px;
      right: 2px;
      display: flex;
      transition: all 0.2s;
      opacity: 0 !important;
      .operation-item {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 25px;
        height: 25px;
        // border-radius: 50%;
        border-radius: 10px;
        svg {
          width: 16px;
          height: 16px;
        }
      }
    }

    .image-resize-handle.visible,
    .operation.visible {
      opacity: 1 !important;
    }
  }

  milkdown-slash-menu,
  milkdown-markdown-menu {
    &[data-show='false'] {
      display: none;
    }
    position: fixed;
    display: block;
    font-family: var(--crepe-font-default);
    color: var(--crepe-color-on-surface);
    background: var(--crepe-color-surface);
    border-radius: 12px;
    box-shadow: var(--crepe-shadow-1);

    ul {
      list-style-type: none;
      li {
        cursor: pointer;
        border-radius: 8px;
      }
    }

    .menu-groups {
      padding: 0 12px 12px;
      max-height: 420px;
      overflow: auto;
      overscroll-behavior: contain;
      scroll-behavior: smooth;

      .menu-group {
        h6 {
          font-size: 14px;
          font-style: normal;
          font-weight: 600;
          line-height: 20px;
          padding: 14px 10px;
          text-transform: uppercase;
          color: color-mix(in srgb, var(--crepe-color-on-surface), transparent 40%);
        }

        li {
          min-width: 220px;
          display: flex;
          justify-content: flex-start;
          align-items: center;
          gap: 16px;
          padding: 14px 10px;
          &.hover {
            background: var(--crepe-color-hover);
          }
          &.active {
            background: var(--crepe-color-selected);
          }

          & > svg {
            width: 24px;
            height: 24px;
            color: var(--crepe-color-outline);
            fill: var(--crepe-color-outline);
          }
          & > span {
            font-size: 14px;
            font-style: normal;
            font-weight: 600;
            line-height: 20px;
          }
        }
      }

      .menu-group + .menu-group::before {
        content: '';
        display: block;
        height: 1px;
        background: color-mix(in srgb, var(--crepe-color-outline), transparent 80%);
        margin: 0 10px;
      }
    }
  }
}
